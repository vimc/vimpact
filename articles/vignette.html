<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using vimpact for estimating vaccine impact - VIMC members â€¢ vimpact</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using vimpact for estimating vaccine impact - VIMC members">
<meta property="og:description" content="vimpact">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vimpact</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/internal-impact.html">Using vimpact for estimating vaccine impact - internal</a>
    </li>
    <li>
      <a href="../articles/using-vimpact.html">Using vimpact for estimating vaccine impact</a>
    </li>
    <li>
      <a href="../articles/vignette.html">Using vimpact for estimating vaccine impact - VIMC members</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using vimpact for estimating vaccine impact - VIMC members</h1>
                        <h4 class="author">Xiang Li</h4>
            
            <h4 class="date">2021-11-11</h4>
      
      
      <div class="hidden name"><code>vignette.Rmd</code></div>

    </div>

    
    
<p>This vignette describes how to use vimpact to estiamte vaccine impact for members of the VIMC team. It describes how to use methods which require access to the montagu database and so cannot be used by external users.</p>
<p>Vimpact provides a set of methodologies developed by VIMC Science Team for quantifying vaccination impact in terms of cases averted, deaths averted and DALYs (disability-adjusted life years) averted. It also stores functions that extract frequently used data sets from Montagu and Annex database.</p>
<p><strong>[todo]</strong> Add a link to our impact calculation methods</p>
<p>Vimpact is primarily developed for VIMC internal users. It contains various functions for reporting and analytic purposes.</p>
<div id="frequently-used-functions-communicating-with-montagu-database" class="section level3">
<h3 class="hasAnchor">
<a href="#frequently-used-functions-communicating-with-montagu-database" class="anchor"></a>Frequently used functions communicating with Montagu database</h3>
<p>There are a set of frequently used functions that extracts data from VIMC databases.</p>
<p><strong>Determine latest touchstone version</strong></p>
<p>Montagu data is touchstone based. Each touchstone may contain multiple versions as it is developed. The most recent version of touchstone can be determined by <code>get_touchstone</code> where <code>con</code> specifies the database machine, and <code>touchstone_name</code> indicates the touchstone of interest.</p>
<pre><code>get_touchstone(con, touchstone_name = "201710gavi")</code></pre>
<p>This will return <code>201710gavi-6</code>. <code>201710gavi</code> touchstone has 6 versions. And Version 6 has the most recent coverage scenarios.</p>
<p><strong>Extract demographic data</strong> Demographic data is frequently used for analysis. It is therefore useful to have a standardized function extracting demographic data from Montagu.</p>
<pre><code>get_population(con, touchstone_pop = "201710gavi-5", demographic_statistic = "int_pop", gender = "Both",
               country_ = NULL, year_ = NULL, age_ = NULL)</code></pre>
<p><code>demographic_statistic</code> is demographic_statistic_type code; <code>gender</code> can be <code>Female, Male or Both</code> if specified or all three selections if NULL; <code>country_</code> is all VIMC countries if NULL or an array of selected countries; similar for <code>year_</code> and <code>age_</code>.</p>
<p><strong>Extract vaccination coverage data</strong></p>
<pre><code>extract_vaccination_history(con, touchstone_cov = "201710gavi", touchstone_pop = NULL,
                            year_min = 2000, year_max = 2100,
                            vaccine_to_ignore = c("DTP3", "HepB_BD_home", "none"),
                            disease_to_extract = NULL,
                            countries_to_extract = NULL,
                            gavi_support_levels = c("with", "bestminus"),
                            scenario_type = "default", external_population_estimates = NULL, full_description = TRUE)</code></pre>
</div>
<div id="annex-views-susy-to-add" class="section level3">
<h3 class="hasAnchor">
<a href="#annex-views-susy-to-add" class="anchor"></a>Annex views (Susy to add)</h3>
</div>
<div id="vaccine-impact-calculations" class="section level3">
<h3 class="hasAnchor">
<a href="#vaccine-impact-calculations" class="anchor"></a>Vaccine impact calculations</h3>
<p><strong>prepare impact calculation recipe</strong> Impact calculation differs according to vaccination scenarios under investigation. Vimpact compares two distinct scenarios, namely the baseline and the focal. Vaccination impact is evaluated as excessive disease burden of focal scenario compared to the baseline. A impact recipe contains meta information of the two scenarios for each particular disease, touchstone and modelling group.</p>
<p>Firstly, <code>recipe_tempate</code> generates a sample impact recipe, from which users can develop their own recipes. Current vimpact allows four views of impact recipes (method0, method1, method2a and method2b) representing vaccine impact by calendar year, year of birth, year of vaccination (vaccination activity perspective) and year of vaccination (birth cohort perspective). The following row of code gives an example recipe of impact by year of birth.</p>
<pre><code>recipe_template(template_version = "201710", method = "method1")</code></pre>
<p>Once impact recipes are complete, vimpact prepares meta data needed for communicating with VIMC databases via <code>get_meta_from_recipe function</code>. Each pair of scenarios (focal and baseline) are indexed for further impact calculation.</p>
<pre><code>get_meta_from_recipe(default_recipe = TRUE, method = "method1", recipe_version = "201710", recipe = NULL, con, disease = "Hib")</code></pre>
<p><code>default_recipe, method and recipe_version</code> combined determine default VIMC impact recipes commonly used for reporting. If user specified recipe is used (a recipe developed from recipe_template), the recipe csv file path should be specified as <code>recipe = &lt;file_path&gt;``.</code>disease` can help to allow focused evaluation of vaccine impact. If it is NULL, all diseases will be considered.</p>
<p><strong>impact by calendar year</strong></p>
<pre><code>meta &lt;- get_meta_from_recipe(default_recipe = TRUE, method = "method0", recipe_version = "201710", recipe = NULL, con, disease = "Hib")

meta_s &lt;- split(meta, meta$index)

dat &lt;- lapply(meta_s, function(meta1) get_raw_impact_details(con = con_test, meta1, burden_outcome = "deaths"))

dat &lt;- do.call(rbind, dat)</code></pre>
<p><strong>impact by year of birth</strong></p>
<pre><code>meta &lt;- get_meta_from_recipe(default_recipe = TRUE, method = "method1", recipe_version = "201710", recipe = NULL, con, disease = "Hib")

meta_s &lt;- split(meta, meta$index)

dat &lt;- lapply(meta_s, function(meta1) get_raw_impact_details(con = con_test, meta1, burden_outcome = "deaths"))

dat &lt;- do.call(rbind, dat)</code></pre>
<p><strong>impact by year of vaccination: impact ratio stratified by activity type (method 2a)</strong></p>
<pre><code>vaccination_years &lt;- 2000:2018

meta &lt;- get_meta_from_recipe(default_recipe = TRUE, method = "method2a", recipe_version = "201710", recipe = NULL, con, disease = "Hib")

meta_s &lt;- split(meta, meta$index)

dat &lt;- lapply(metas, function(meta1) get_raw_impact_details(con = con_test, meta1, burden_outcome = "deaths"))

dat &lt;- do.call(rbind, dat)

fvps &lt;- extract_vaccination_history(con, touchstone_cov = "201710gavi", touchstone_pop = NULL,
                                    year_min = min(vaccination_years), year_max = max(vaccination_years),
                                    disease_to_extract = "Hib",
                                    countries_to_extract = "AFG")

dat2 &lt;- lapply(metas, function(meta1) impact_by_year_of_vaccination(meta1, raw_impact = dat, fvps = fvps,
                                                                    vaccination_years = vaccination_years))

dat2 &lt;- do.call(rbind, dat2)
</code></pre>
<p><strong>impact by year of vaccination: impact ratio stratified by birth cohort (method 2b)</strong></p>
<pre><code>meta &lt;- get_meta_from_recipe(default_recipe = TRUE, method = "method2b", recipe_version = "201710", recipe = NULL, con, disease = "Hib")

meta_s &lt;- split(meta, meta$index)

dat &lt;- lapply(metas, function(meta1) get_raw_impact_details(con = con_test, meta1, burden_outcome = "deaths"))

dat &lt;- do.call(rbind, dat)

fvps &lt;- extract_vaccination_history(con, touchstone_cov = "201710gavi", touchstone_pop = NULL,
                                    year_min = min(vaccination_years), year_max = max(vaccination_years),
                                    disease_to_extract = "Hib",
                                    countries_to_extract = "AFG")

dat2 &lt;- lapply(metas, function(meta1) impact_by_year_of_vaccination(meta1, raw_impact = dat, fvps = fvps,
                                                                    vaccination_years = vaccination_years))

dat2 &lt;- do.call(rbind, dat2)
</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Rich FitzJohn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
